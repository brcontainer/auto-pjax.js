/* Pjax.js 0.6.0 | Copyright (c) 2020 Guilherme Nascimento (brcontainer@yahoo.com.br) | Released under the MIT license */

!function(e){var t,n,r,a,o="undefined"!=typeof window?window:{},i=o.document||{},l=o.history,c=o.URL,s=!!o.DOMParser,u={},d=i.implementation,p=o.location.protocol.replace(/:/g,"")+"://"+o.location.host,f=/^(input|textarea|select|datalist|button|output)$/i,h=!1,m=o.Element&&o.Element.prototype,v=Array.prototype.slice,g={supported:!!(m&&l.pushState&&(s||d&&d.createHTMLDocument)),remove:P,start:function(e){if(!/^https?:$/.test(o.location.protocol)||!g.supported)return;for(var t in P(),n={linkSelector:"a:not([data-pjax-ignore]):not([href^='#']):not([href^='javascript:'])",formSelector:"form:not([data-pjax-ignore]):not([action^='javascript:'])",containers:["#pjax-container"],updatecurrent:!1,updatehead:!0,insertion:!0,scrollLeft:0,scrollTop:0,nocache:!1,loader:!0,proxy:""})e&&t in e&&(n[t]=e[t]);e=null,/^(interactive|complete)$/.test(i.readyState)?U():i.addEventListener("DOMContentLoaded",U)},request:function(e,t){D(e,t.replace?2:1,t.method,null,t.data)},on:function(e,t){y(e,t)},off:function(e,t){y(e,t,!0)}};if(s)try{var x=T("<html><head><title>1</title></head><body>1</body></html>");s=!!(x.head&&x.title&&x.body)}catch(e){s=!1}function S(){if(r)return clearTimeout(r),r=0,a.className="pjax-loader pjax-hide",void setTimeout(S,20);a||((a=i.createElement("div")).innerHTML='<div class="pjax-progress"></div>',i.body.appendChild(a)),a.className="pjax-loader pjax-start",r=setTimeout(function(){r=0,a.className+=" pjax-inload"},10)}function L(t,n,r){[].slice.call(t.querySelectorAll(n)).forEach(r),r=e}function T(e){if(s)return(new DOMParser).parseFromString(e,"text/html");var t=d.createHTMLDocument("");return/^\s*<(\!doctype|html)[^>]*>/i.test(e)?(t.documentElement.innerHTML=e,t.body&&t.head||(t=d.createHTMLDocument("")).write(e)):t.body.innerHTML=e,t}function j(e,t,n,r){if(u[e])for(var a=u[e],o=0;o<a.length;o++)a[o](t,n,r)}function y(e,t,n){"function"==typeof t&&(u[e]||(u[e]=[]),n?u[e]=u[e].filter(function(e){return e!==t}):u[e].push(t))}function E(e,t,n,r){var a,c=T(t),s=c.title||"",d=n.containers,p=n.insertion,f=n.scrollLeft>0?+n.scrollLeft:o.scrollX||o.pageXOffset,h=n.scrollTop>0?+n.scrollTop:o.scrollY||o.pageYOffset;if(r){var m={pjaxUrl:e,pjaxData:t,pjaxConfig:n};1===r?l.pushState(m,s,e):2===r&&l.replaceState(m,s,e)}if(u.dom)return j("dom",e,c);n.updatehead&&c.head&&function(e){var t,n,r,a=[],o=e.children;for(t=o.length-1;t>=0;t--)"TITLE"!==o[t].tagName&&a.push(o[t].outerHTML);for(t=(o=i.head.children).length-1;t>=0;t--)"TITLE"===o[t].tagName||M(o[t],"resource")||(-1===(n=a.indexOf(o[t].outerHTML))?o[t].parentNode.removeChild(o[t]):a.splice(n,1));for((r=i.createElement("div")).innerHTML=a.join(""),t=(o=r.children).length-1;t>=0;t--)M(o[t],"resource")||i.head.appendChild(o[t]);r=a=null}(c.head),i.title=s;for(var g=d.length-1;g>=0;g--)(a=c.body.querySelector(d[g]))&&L(i,d[g],function(e){if("append"===p||"prepend"===p){for(var t=i.createDocumentFragment(),n=0,r=v.call(a.childNodes),o=r.length;n<o;++n)t.appendChild(r[n]);"append"===p?e.appendChild(t):e.insertBefore(t,e.firstChild),t=null}else e.innerHTML=a.innerHTML});o.scrollTo(f,h),c=d=null}function M(e,t){var n=e.getAttribute("data-pjax-"+t);if("true"===n||"false"===n)return"true"===n;if(!isNaN(n))return parseFloat(n);if(/^\[[\s\S]+\]$|^\{[^:]+[:][\s\S]+\}$/.test(n))try{n=JSON.parse(n)}catch(e){}return n}function C(e,t,n,o,i,l){t.loader&&(r&&clearTimeout(r),a.className+=" pjax-end",r=setTimeout(function(){r=0,a.className+=" pjax-hide"},1e3)),l&&E(e,l,t,n),j(l?"done":"fail",e),j("then",e),i&&new Function(i).call(o)}function N(){t&&t.abort()}function D(e,r,a,o,l){N();var s=function(e){var t,r,a=JSON.parse(JSON.stringify(n)),o=["containers","updatecurrent","updatehead","insertion","loader","scroll-left","scroll-top","done","fail"];if(!e)return a;for(var i=o.length-1;i>=0;i--)(r=M(e,t=o[i]))&&(a[t=t.toLowerCase().replace(/-([a-z])/g,function(e,t){return t.toUpperCase()})]=r);return a}(o);if(j("initiate",e,s),s.loader&&S(),u.handler)return j("handler",{url:e,state:r,method:a,element:o},s,C);var d={"X-PJAX-Container":s.containers.join(","),"X-PJAX":"true"},p=n.proxy||e;for(var f in n.nocache&&(p=function(e){var t,n="_="+ +new Date;return c?(t=i.createElement("a")).href=e:t=new c(e),t.search+=(t.search?"&":"?")+n,e=t+"",t=null,e}(e)),(t=new XMLHttpRequest).open(a,p,!0),d)t.setRequestHeader(f,d[f]);t.onreadystatechange=function(){if(4===this.readyState){var n=this.status;if(n>=200&&n<300){var a=t.getResponseHeader("X-PJAX-Container");a&&(s.containers=a.split(",")),C(t.getResponseHeader("X-PJAX-URL")||e,s,r,o,s.done,this.responseText)}else C(e,s,n,o,s.fail)}},t.send(l||"")}function H(e){if(0===e.button){var t,r,a=e.target;if(a.matches(n.linkSelector))t=a.href;else{for(;a=a.parentNode;)if("A"===a.tagName){r=a;break}if(!r||!r.matches(n.linkSelector))return;t=(a=r).href}w("GET",t,null,a,e)}}function b(e){var t,r,a,i=e.target;if(i.matches(n.formSelector)&&("POST"!==(a=String(i.method).toUpperCase())||o.FormData)){if(t=i.action,"POST"!==a||"multipart/form-data"!==i.enctype)r=function(e){var t=[];return L(e,"[name]",function(e){e.name&&f.test(e.tagName)&&t.push(encodeURIComponent(e.name)+"="+encodeURIComponent(e.value))}),t.join("&")}(i),"POST"!==a&&(t=t.replace(/\?.*/g,"")+"?",r&&(t+=r),r=null);else{if(!o.FormData)return;r=new FormData(i)}w(a,t,r,i,e)}}function w(e,t,r,a,i){0!==t.indexOf(p+"/")&&t!==p||(i.preventDefault(),t!==o.location+""||"POST"===e?D(t,1,e,a,r):n.updatecurrent&&D(t,2,e,a,r))}function O(e){e.state&&e.state.pjaxUrl&&(N(),E(e.state.pjaxUrl,e.state.pjaxData,e.state.pjaxConfig,!1),j("history",e.state.pjaxUrl,e.state))}function U(){if(!h){h=!1;var e=o.location+"",t=o.history.state;t&&t.pjaxUrl||l.replaceState({pjaxUrl:e,pjaxData:i.documentElement.outerHTML,pjaxConfig:n},i.title,e),o.addEventListener("unload",N),o.addEventListener("popstate",O),n.linkSelector&&i.addEventListener("click",H),n.formSelector&&i.addEventListener("submit",b)}}function P(){n&&h&&(i.removeEventListener("click",H),i.removeEventListener("submit",b),o.removeEventListener("unload",N),o.removeEventListener("popstate",O),h=!1,n=e)}m&&!m.matches&&(m.matches=m.matchesSelector||m.mozMatchesSelector||m.msMatchesSelector||m.oMatchesSelector||m.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),n=m.length;--n>=0&&t[n]!==this;);return n>-1}),o.Pjax=g}();
